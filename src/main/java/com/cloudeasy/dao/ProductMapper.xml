<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cloudeasy.dao.ProductMapper">
  <resultMap id="BaseResultMap" type="com.cloudeasy.model.Product">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <constructor>
      <idArg column="id" javaType="java.lang.Integer" jdbcType="INTEGER" />
      <arg column="product_name" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="pic_src" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="product_desc" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="table_relate_flag" javaType="java.lang.String" jdbcType="CHAR" />
      <arg column="table_id" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="pw" javaType="java.lang.Integer" jdbcType="INTEGER" />
      <arg column="create_time" javaType="java.util.Date" jdbcType="TIMESTAMP" />
      <arg column="create_user" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="flag" javaType="java.lang.String" jdbcType="CHAR" />
      <arg column="taobao_url" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="short_desc" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="noteKey1" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="noteValue1" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="noteKey2" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="noteValue2" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="noteKey3" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="noteValue3" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="noteKey4" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="noteValue4" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="noteDesc1" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="noteDesc2" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="noteDesc3" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="noteDesc4" javaType="java.lang.String" jdbcType="VARCHAR" />
      <arg column="mainProductId" javaType="java.lang.Integer" jdbcType="INTEGER" />
      <arg column="language" javaType="java.lang.String" jdbcType="VARCHAR"/>
    </constructor>
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    id, product_name, pic_src, product_desc, table_relate_flag, table_id, pw, create_time, 
    create_user, flag, taobao_url,short_desc,noteKey1,noteValue1,noteKey2,noteValue2,noteKey3,noteValue3,noteKey4,noteValue4,
    noteDesc1,noteDesc2,noteDesc3,noteDesc4,mainProductId,language
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from product_tbl
    where id = #{id,jdbcType=INTEGER}
  </select>
  
  <select id="selectProductsByCondition" 
        parameterType="com.cloudeasy.mybatis.DynamicParameter" resultMap="BaseResultMap">
    select 
        T1.id,T1.product_name,T1.pic_src,T1.product_desc,T1.table_relate_flag,T1.table_id,T1.pw,T1.create_time, 
    	T1.create_user,T1.flag,T1.taobao_url,T1.short_desc,T1.noteKey1,T1.noteValue1,T1.noteKey2,T1.noteValue2,
    	T1.noteKey3,T1.noteValue3,T1.noteKey4,T1.noteValue4,
		T1.noteDesc1,T1.noteDesc2,T1.noteDesc3,T1.noteDesc4,T1.mainProductId,T1.language
    from 
        product_tbl T1 
        inner join product_category_tbl T2  on T1.id = T2.product_id 
        inner join category_tbl T3 on T3.id = T2.category_id
    where
    	1=1
    	<if test="categoryName != null and categoryName != '' ">
	    	and T3.name == #{categoryName}
	    </if>
        <if test="categoryId != null and categoryId != '' ">
	    	and T3.id == #{categoryId}
	    </if>
  </select>
  
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from product_tbl
    where id = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.cloudeasy.model.Product">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <selectKey keyProperty="id" order="AFTER" resultType="java.lang.Integer">
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into product_tbl (product_name, pic_src, product_desc, 
      table_relate_flag, table_id, pw, 
      create_time, create_user, flag, 
      taobao_url,short_desc,noteKey1,noteValue1,noteKey2,noteValue2,noteKey3,noteValue3,noteKey4,noteValue4,
      noteDesc1,noteDesc2,noteDesc3,noteDesc4,mainProductId,language)
    values (#{productName,jdbcType=VARCHAR}, #{picSrc,jdbcType=VARCHAR}, #{productDesc,jdbcType=VARCHAR}, 
      #{tableRelateFlag,jdbcType=CHAR}, #{tableId,jdbcType=VARCHAR}, #{pw,jdbcType=INTEGER}, 
      #{createTime,jdbcType=TIMESTAMP}, #{createUser,jdbcType=VARCHAR}, #{flag,jdbcType=CHAR}, 
      #{taobaoUrl,jdbcType=VARCHAR}, #{shortDesc,jdbcType=VARCHAR}, #{noteKey1,jdbcType=VARCHAR}, #{noteValue1,jdbcType=VARCHAR},
      #{noteKey2,jdbcType=VARCHAR}, #{noteValue2,jdbcType=VARCHAR}, #{noteKey3,jdbcType=VARCHAR}, #{noteValue3,jdbcType=VARCHAR},
      #{noteKey4,jdbcType=VARCHAR}, #{noteValue4,jdbcType=VARCHAR}, #{noteDesc1,jdbcType=VARCHAR}, #{noteDesc2,jdbcType=VARCHAR},
      #{noteDesc3,jdbcType=VARCHAR}, #{noteDesc4,jdbcType=VARCHAR}, #{mainProductId,jdbcType=INTEGER},#{language,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.cloudeasy.model.Product">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <selectKey keyProperty="id" order="AFTER" resultType="java.lang.Integer">
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into product_tbl
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="productName != null">
        product_name,
      </if>
      <if test="picSrc != null">
        pic_src,
      </if>
      <if test="productDesc != null">
        product_desc,
      </if>
      <if test="tableRelateFlag != null">
        table_relate_flag,
      </if>
      <if test="tableId != null">
        table_id,
      </if>
      <if test="pw != null">
        pw,
      </if>
      <if test="createTime != null">
        create_time,
      </if>
      <if test="createUser != null">
        create_user,
      </if>
      <if test="flag != null">
        flag,
      </if>
      <if test="taobaoUrl != null">
        taobao_url,
      </if>
      <if test="shortDesc != null">
        short_desc,
      </if>
      <if test="noteKey1 != null">
        noteKey1,
      </if>
      <if test="noteValue1 != null">
        noteValue1,
      </if>
      <if test="noteKey2 != null">
        noteKey2,
      </if>
      <if test="noteValue2 != null">
        noteValue2,
      </if>
      <if test="noteKey3 != null">
        noteKey3,
      </if>
      <if test="noteValue3 != null">
        noteValue3,
      </if>
      <if test="noteKey4 != null">
        noteKey4,
      </if>
      <if test="noteValue4 != null">
        noteValue4,
      </if>
      <if test="noteDesc1 != null">
        noteDesc1,
      </if>
      <if test="noteDesc2 != null">
        noteDesc2,
      </if>
      <if test="noteDesc3 != null">
        noteDesc3,
      </if>
      <if test="noteDesc4 != null">
        noteDesc4,
      </if>
      <if test="mainProductId != null">
        mainProductId,
      </if>
      <if test="language != null">
        language,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="productName != null">
        #{productName,jdbcType=VARCHAR},
      </if>
      <if test="picSrc != null">
        #{picSrc,jdbcType=VARCHAR},
      </if>
      <if test="productDesc != null">
        #{productDesc,jdbcType=VARCHAR},
      </if>
      <if test="tableRelateFlag != null">
        #{tableRelateFlag,jdbcType=CHAR},
      </if>
      <if test="tableId != null">
        #{tableId,jdbcType=INTEGER},
      </if>
      <if test="pw != null">
        #{pw,jdbcType=INTEGER},
      </if>
      <if test="createTime != null">
        #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="createUser != null">
        #{createUser,jdbcType=VARCHAR},
      </if>
      <if test="flag != null">
        #{flag,jdbcType=CHAR},
      </if>
      <if test="taobaoUrl != null">
        #{taobaoUrl,jdbcType=VARCHAR},
      </if>
      <if test="shortDesc != null">
        #{shortDesc,jdbcType=VARCHAR},
      </if>
      <if test="noteKey1 != null">
        #{noteKey1,jdbcType=VARCHAR},
      </if>
      <if test="noteValue1 != null">
        #{noteValue1,jdbcType=VARCHAR},
      </if>
      <if test="noteKey2 != null">
        #{noteKey2,jdbcType=VARCHAR},
      </if>
      <if test="noteValue2 != null">
        #{noteValue2,jdbcType=VARCHAR},
      </if>
      <if test="noteKey3 != null">
        #{noteKey3,jdbcType=VARCHAR},
      </if>
      <if test="noteValue3 != null">
        #{noteValue3,jdbcType=VARCHAR},
      </if>
      <if test="noteKey4 != null">
        #{noteKey4,jdbcType=VARCHAR},
      </if>
      <if test="noteValue4 != null">
        #{noteValue4,jdbcType=VARCHAR},
      </if>
      <if test="noteDesc1 != null">
        #{noteDesc1,jdbcType=VARCHAR},
      </if>
      <if test="noteDesc2 != null">
        #{noteDesc2,jdbcType=VARCHAR},
      </if>
      <if test="noteDesc3 != null">
        #{noteDesc3,jdbcType=VARCHAR},
      </if>
      <if test="noteDesc4 != null">
        #{noteDesc4,jdbcType=VARCHAR},
      </if>
      <if test="mainProductId != null">
        #{mainProductId,jdbcType=INTEGER},
      </if>
      <if test="language != null">
        #{language,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.cloudeasy.model.Product">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update product_tbl
    <set>
      <if test="productName != null">
        product_name = #{productName,jdbcType=VARCHAR},
      </if>
      <if test="picSrc != null">
        pic_src = #{picSrc,jdbcType=VARCHAR},
      </if>
      <if test="productDesc != null">
        product_desc = #{productDesc,jdbcType=VARCHAR},
      </if>
      <if test="tableRelateFlag != null">
        table_relate_flag = #{tableRelateFlag,jdbcType=CHAR},
      </if>
      <if test="tableId != null">
        table_id = #{tableId,jdbcType=VARCHAR},
      </if>
      <if test="pw != null">
        pw = #{pw,jdbcType=INTEGER},
      </if>
      <if test="createTime != null">
        create_time = #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="createUser != null">
        create_user = #{createUser,jdbcType=VARCHAR},
      </if>
      <if test="flag != null">
        flag = #{flag,jdbcType=CHAR},
      </if>
      <if test="taobaoUrl != null">
        taobao_url = #{taobaoUrl,jdbcType=VARCHAR},
      </if>
      <if test="shortDesc != null">
        short_desc = #{shortDesc,jdbcType=VARCHAR},
      </if>
      <if test="noteKey1 != null">
        noteKey1 = #{noteKey1,jdbcType=VARCHAR},
      </if>
      <if test="noteValue1 != null">
        noteValue1 = #{noteValue1,jdbcType=VARCHAR},
      </if>
      <if test="noteKey2 != null">
        noteKey2 = #{noteKey2,jdbcType=VARCHAR},
      </if>
      <if test="noteValue2 != null">
        noteValue2 = #{noteValue2,jdbcType=VARCHAR},
      </if>
      <if test="noteKey3 != null">
        noteKey3 = #{noteKey3,jdbcType=VARCHAR},
      </if>
      <if test="noteValue1 != null">
        noteValue3 = #{noteValue3,jdbcType=VARCHAR},
      </if>
      <if test="noteKey1 != null">
        noteKey4 = #{noteKey4,jdbcType=VARCHAR},
      </if>
      <if test="noteValue4 != null">
        noteValue4 = #{noteValue4,jdbcType=VARCHAR},
      </if>
      <if test="noteDesc1 != null">
        noteDesc1 = #{noteDesc1,jdbcType=VARCHAR},
      </if>
      <if test="noteDesc2 != null">
        noteDesc2 = #{noteDesc2,jdbcType=VARCHAR},
      </if>
      <if test="noteDesc3 != null">
        noteDesc3 = #{noteDesc3,jdbcType=VARCHAR},
      </if>
      <if test="noteDesc4 != null">
        noteDesc4 = #{noteDesc4,jdbcType=VARCHAR},
      </if>
      <if test="mainProductId != null">
        mainProductId = #{mainProductId,jdbcType=INTEGER},
      </if>
      <if test="language != null">
        language = #{language,jdbcType=VARCHAR},
      </if>
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.cloudeasy.model.Product">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update product_tbl
    set product_name = #{productName,jdbcType=VARCHAR},
      pic_src = #{picSrc,jdbcType=VARCHAR},
      product_desc = #{productDesc,jdbcType=VARCHAR},
      table_relate_flag = #{tableRelateFlag,jdbcType=CHAR},
      table_id = #{tableId,jdbcType=VARCHAR},
      pw = #{pw,jdbcType=INTEGER},
      create_time = #{createTime,jdbcType=TIMESTAMP},
      create_user = #{createUser,jdbcType=VARCHAR},
      flag = #{flag,jdbcType=CHAR},
      taobao_url = #{taobaoUrl,jdbcType=VARCHAR},
      short_desc = #{shortDesc,jdbcType=VARCHAR},
      noteKey1 = #{noteKey1,jdbcType=VARCHAR},
      noteValue1 = #{noteValue1,jdbcType=VARCHAR},
      noteKey2 = #{noteKey2,jdbcType=VARCHAR},
      noteValue2 = #{noteValue2,jdbcType=VARCHAR},
      noteKey3 = #{noteKey3,jdbcType=VARCHAR},
      noteValue3 = #{noteValue3,jdbcType=VARCHAR},
      noteKey4 = #{noteKey4,jdbcType=VARCHAR},
      noteValue4 = #{noteValue4,jdbcType=VARCHAR},
      noteDesc1 = #{noteDesc1,jdbcType=VARCHAR},
      noteDesc2 = #{noteDesc2,jdbcType=VARCHAR},
      noteDesc3 = #{noteDesc3,jdbcType=VARCHAR},
      noteDesc4 = #{noteDesc4,jdbcType=VARCHAR},
      mainProductId = #{mainProductId,jdbcType=INTEGER},
      language = #{language,jdbcType=VARCHAR}
    where id = #{id,jdbcType=INTEGER}
  </update>
  
   <!-- 新增  start-->
  <!-- 系统品牌 列表总数-->
	<select id="queryByCount" parameterType="com.cloudeasy.dto.BaseDTO" resultType="java.lang.Integer">
		select count(1) from product_tbl 
		where 1=1 
		<if test="productName != null and productName != ''">
	    	and product_name like CONCAT('%', #{productName}, '%')
		</if>
		<if test="tableId != null and tableId != ''">
	    	and table_id = #{tableId}
		</if>
		<if test="isMainProduct != null and isMainProduct == 1">
	    	and mainProductId is null
		</if>
		<if test="isMainProduct != null and isMainProduct == 0">
	    	and mainProductId is not null
		</if>
		<if test="language != null and language != ''">
	    	and language = #{language}
		</if>
	</select>
	<!-- 查询品牌是否存在 -->
    <select id="isBrandName" parameterType="com.cloudeasy.dto.BaseDTO" resultType="java.lang.Integer">
		select count(1) from product_tbl 
		where 1=1
		<!-- and product_name like CONCAT('%', #{productName}, '%') --> 
		<if test="productName != null and productName != ''">
	    	and product_name = #{productName}
		</if>
		<if test="brandType != null and brandType != ''">
	    	and table_id  = #{brandType}
		</if>
		<if test="language != null and language != ''">
	    	and language = #{language}
		</if>
	</select>
	<!-- 查询系统品牌列表 -->
	<select id="queryByList" parameterType="com.cloudeasy.dto.BaseDTO" resultMap="BaseResultMap">
		select 
		<include refid="Base_Column_List" />
		from product_tbl 
		where 1=1
			<if test="productName != null and productName != ''">
	    	and product_name like CONCAT('%', #{productName}, '%')
		    </if>
		    <if test="tableId != null and tableId != ''">
	    	and table_id = #{tableId}
		    </if>
		    <if test="language != null and language != ''">
		    and language = #{language}
			</if>
		    <if test="isMainProduct != null and isMainProduct == 1">
	    	and mainProductId is null
		    </if>
		    <if test="isMainProduct != null and isMainProduct == 0">
	    	and mainProductId is not null
		    </if>
		    order by pw asc
			<if test="pager.orderCondition != null and pager.orderCondition != ''">
		      ${pager.orderCondition}
		    </if>
		    <if test="pager.mysqlQueryCondition != null and pager.mysqlQueryCondition != ''">
		       ${pager.mysqlQueryCondition}
		    </if>
		    
	</select>
	
	<select id="getTotalRows" parameterType="com.cloudeasy.common.DataGridModel" resultType="java.lang.Integer">
		select count(1) from product_tbl 
		where 1=1 
		<if test="params.productName != null and params.productName != ''">
	    	and product_name like CONCAT('%', #{params.productName}, '%')
		</if>
		<if test="params.language != null and params.language != ''">
	    	and language = #{params.language}
		</if>
		 <if test="params.tableId != null and params.tableId != ''">
	    	and table_id = #{params.tableId}
		   </if>
			
	</select>
	
	<!-- 查询菜单列表 -->
	<select id="queryList" parameterType="com.cloudeasy.common.DataGridModel" resultMap="BaseResultMap">
		select 
		<include refid="Base_Column_List" />
		from product_tbl 
		where 1=1
	    <if test="params.tableId != null and params.tableId != ''">
    		and table_id = #{params.tableId}
	    </if> 
	    <if test="params.language != null and params.language != ''">
	    	and language = #{params.language}
		</if>
	    order by id asc 
		limit #{page},#{rows}
	</select>
	
	<!-- 查询菜单列表 -->
	<select id="findProductById" parameterType="java.lang.Integer" resultMap="BaseResultMap">
		select 
		<include refid="Base_Column_List" />
		from product_tbl 
		where 1=1 and id = #{id}
	</select>
	
	<!-- 查询子产品列表 -->
	<select id="findProductByMainProductId" parameterType="java.lang.Integer" resultMap="BaseResultMap">
		select 
		<include refid="Base_Column_List" />
		from product_tbl 
		where 1=1 and mainProductId = #{id}
	</select>
	<!-- 新增end -->
</mapper>